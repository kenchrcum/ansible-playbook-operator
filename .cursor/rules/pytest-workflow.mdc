---
alwaysApply: true
description: "Pytest testing workflow and command patterns."
---
# Pytest Testing Workflow

## Running Tests
Always run tests using the virtual environment:
```bash
source .venv/bin/activate
pytest tests/unit/ -v
```

## Test Development
- Use `pytest` for all unit tests
- Run specific test files: `pytest tests/unit/test_filename.py -v`
- Run specific test methods: `pytest tests/unit/test_filename.py::TestClass::test_method -v`
- Use `-s` flag to see print output during debugging
- Use `-q` flag for quiet output when running all tests

## Test Structure
- Import functions to test from the main module
- Use descriptive test method names
- Group related tests in test classes
- Mock external dependencies appropriately
- Assert both expected behavior and error conditions

## Common Patterns
- Mock Kopf patch objects for controller testing
- Mock Kubernetes API calls
- Test condition management and event emission
- Cover validation failure scenarios
- Verify status updates and event emission
